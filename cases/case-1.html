  <!doctype html>
  <html lang="ru">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Синапс — Желчные люди</title>
    <link rel="stylesheet" href="../assets/css/case1-v12.css" />
  </head>

  <body>
    <!-- Главный холст (все координаты left/top/width/height — относительно canvas) -->
    <main class="canvas">

      <div class="c1-text c1-text--logo"><span>Синапс</span><span class="c1-text__badge">Онлайн</span></div>

      <div class="c1-text c1-text--hero">Проект<br>«Желчные люди»</div>

      <div class="c1-text c1-text--case">Клинический случай: «Три проблемы одного "кислого" парня... который оказался не таким уж и кислым»</div>

      <div class="c1-text c1-text--intro">Уважаемый коллега! Перед вами – классический портрет пациента в рамках нашего проекта «Желчные люди». Ваша задача – разобраться в хитросплетениях его диагнозов и выбрать терапию, которая бьет точно в цель.</div>

      <div class="c1-text c1-text--kees">Клинический кейс</div>

      <div class="c1-text c1-text--complaints">Жалобы</div>

      <div class="c1-text c1-text--reception">На приеме пациент, 45 лет</div>

      <div class="c1-text c1-text--complaints-body">
        <p>Тяжесть и дискомфорт в правом подреберье, усиливающиеся после приема <br>жирной пищи, после употребления большого количества кофе <br>(более 1 литра в день), повышенная утомляемость.</p>
        <p>Изжога, практически постоянно, горький привкус во рту, ощущение горечи в <br>горле по утрам. Свои симптомы описывает фразой: <br>«Желчь душит».</p>
      </div>

      <div class="c1-text c1-text--anamnesis">Анамнез заболевания</div>

      <div class="c1-text c1-text--anamnesis-body">Симптомы стал отмечать после 2 лет работы в офисе – «работа нервная, всем постоянно от меня что-то нужно, <br>а мне и поесть нормально некогда».</div>

      <div class="c1-text c1-text--life">Анамнез жизни:</div>

      <div class="c1-text c1-text--life-body">Отмечает малоподвижный образ жизни – работа-дом. Питание нерегулярное, с преобладанием <br>жирной и жареной пищи, фастфудов. Избыточная масса тела (ИМТ 30,5 кг/м²). Употребление алкоголя <br>редко – 1 раз в месяц. На вопрос о настроении отвечает: «Нормальное... если никто не трогает». <br>При повышенной нагрузке на работе становится раздражительным – усиливается горечь во рту.</div>

      <div class="c1-text c1-text--exam">Данные обследования</div>

      <div class="c1-text c1-text--exam-body">УЗИ органов брюшной полости: увеличение правой доли печени, обеднение сосудистого рисунка печени. <br>Размеры желчного пузыря в норме, стенки не утолщены. Мелкодисперсная взвесь в желчном пузыре, <br>с тенденцией к слиянию по типу «хлопьев желчи» и формированию «сладж-конкремента». Заключение: признаки жировой инфильтрации (стеатоза) печени, эхо-взвесь в желчном пузыре, «сладж- <br>конкремент». «Печень просит пощады, желчный пузырь "мутными делами" занимается».</div>

      <div class="c1-text c1-text--fgds">ФГДС: эпителизированная эрозия пищевода. В желудке <br>натощак большое количество желчи. Быстрый уреазный <br>тест Biohit — отрицательный.</div>

      <div class="c1-text c1-text--bio">Биохимический анализ крови: незначительное повышение АЛТ и АСТ (в 1,5 раза от верхней границы нормы). Повышение ГГТ до 2 норм. Уровень всех фракция билирубина в норме.</div>

      <div class="c1-text c1-text--ph">Суточная pH-импедансометрия пищевода: Ключевая находка! Кислотный рефлюкс не регистрируется. Выявлено 80 эпизодов слабощелочного рефлюкса (преимущественно жидкостного), что достоверно подтверждает преобладание желчного (щелочного) компонента.</div>

      <div class="c1-text c1-text--markers">Маркеры вирусных гепатитов отрицательно.</div>

      <div class="c1-text c1-text--diagnosis">Предварительный диагноз</div>

      <div class="c1-text c1-text--diagnosis1">Неалкогольная жировая<br>болезнь печени (МАЖБП/НАЖБП),<br>печеночная ферментемия</div>

      <div class="c1-text c1-text--diagnosis2">Дуоденогастральный рефлюкс<br>с развитием «желчного»<br>рефлюкс-эзофагита</div>

      <div class="c1-text c1-text--diagnosis3">Билиарный сладж.<br>Сладж-конкремент</div>

      <div class="c1-text c1-text--quiz-title">Вопрос квиза</div>

      <div class="c1-text c1-text--quiz-question">Итак, наш пациент – классический «желчный человек». У пациента имеется неалкогольная <br>жировая болезнь печени, билиарный сладж-синдром, сладж-конкремент, рефлюксная болезнь <br>с преобладаем «желчного» рефлюкса. Какой из предложенных вариантов терапии вы считаете <br>наиболее патогенетически обоснованным и комплексным?</div>

      <div class="c1-text c1-text--quiz-prompt">Выберите правильный вариант ответа:</div>

      <div class="c1-text c1-text--quiz-opt1">Ингибитор протонной помпы (ИПП) + урсодезоксихолевая кислота (УДХК)</div>

      <div class="c1-text c1-text--quiz-opt2">Гепатопротектор на основе глицирризиновой кислоты + УДХК (Фосфоглив Урсо) <br>+ прокинетик</div>

      <div class="c1-text c1-text--quiz-opt3">Монотерапия адеметионином</div>

      <!-- Кнопки ответов квиза -->
      <button class="c1-quiz-btn c1-quiz-btn--1" data-answer="1"></button>
      <button class="c1-quiz-btn c1-quiz-btn--2" data-answer="2"></button>
      <button class="c1-quiz-btn c1-quiz-btn--3" data-answer="3"></button>

      <!-- Окно правильного ответа (под footer-bg) -->
      <div class="c1-answer-window" style="z-index:4">
        <div class="c1-aw-handle"></div>
        <div class="c1-aw-title">Правильный<br>ответ</div>
        <div class="c1-aw-line">Гепатопротектор на основе глицирризиновой кислоты + УДХК (Фосфоглив Урсо) + прокинетик</div>
        <div class="c1-aw-label">Пояснение.</div>
        <div class="c1-aw-body">
          <p>Ингибиторы протонной помпы показаны при лечении рефлюксной болезни, обусловленной наличием «кислого» рефлюкса.</p>
          <p>В данной клинической ситуации назначение ИПП патогенетически не обосновано.<sup>1</sup> Более того, при наличии конкрементов желчного пузыря, согласно клиническим рекомендациям МЗ «Желчнокаменная болезнь» — «Всем пациентам с наличием желчных камней пероральная терапия препаратами урсодезоксихолевой кислоты (УДХК) с целью растворения (литолиза) желчных камней не рекомендуется». В связи с чем, данная комбинация не может быть назначена в данной ситуации.<sup>2</sup></p>
          <p>Монотерапия молекулой адеметионин патогенетически не обоснована, учитывая отсутствие влияния молекулы на реологические свойства желчи, а также низкий уровень убедительности рекомендаций – В, и уровень достоверности доказательств – 2.</p>
          <p>В данном кейсе патогенетическое обоснование к применению имеет гепатопротектор на основе глицирризиновой кислоты + УДХК (Фосфоглив Урсо) + в сочетании с прокинетиком.</p>
          <p>УДХК оказывает желчегонное действие, способствует растворению конкрементов в желчном пузыре, стимулирует образование и выделение желчи. ГК оказывает антиоксидантное и противовоспалительное действие.<sup>3,4</sup></p>
          <p>Таким образом, в данном случае комбинация глицирризиновой кислоты + УДХК оказывает синергетическое действие на оба ключевых звена патогенеза заболеваний желчевыводящей системы — застой желчи и воспаление, а также последствия дуоденогастрального рефлюкса.<sup>5,6</sup></p>
        </div>
      </div>

      <div class="c1-footer-bg" style="z-index:5"></div>

      <div class="c1-text c1-text--info-title" style="z-index:20">Информация для специалистов здравоохранения</div>

      <div class="c1-text c1-text--ref-heading" style="z-index:20">Список литературы</div>

      <div class="c1-text c1-text--ref-list" style="z-index:20">
        <ol>
          <li>Ивашкин В.Т., Трухманов А.С., Маев И.В., Драпкина О.М., Ливзан М.А. и&nbsp;соавт. Диагностика и&nbsp;лечение
          гастроэзофагеальной рефлюксной болезни (Рекомендации Российской гастроэнтерологической ассоциации, Российского научного
          медицинского общества терапевтов, Российского общества профилактики неинфекционных заболеваний, Научного сообщества
          по&nbsp;изучению микробиома человека). Российский журнал гастроэнтерологии, гепатологии,
          колопроктологии.&nbsp;2024;34(5):111&mdash;135. <a href="https://doi.org/10.22416/1382-4376-2024-34-5-111-135" class="c1-ref-link" target="_blank" rel="noopener">https://doi.org/10.22416/1382-4376-2024-34-5-111-135</a></li>
          <li>Клинические рекомендации. Желчнокаменная болезнь. 2024. Ссылка активна на 24.10.2025. <a href="https://cr.minzdrav.gov.ru/preview-cr/580_3" class="c1-ref-link" target="_blank" rel="noopener">https://cr.minzdrav.gov.ru/preview-cr/580_3</a></li>
          <li>Инструкция по медицинскому применению лекарственного препарата Фосфоглив® УРСО</li>
          <li>Мехтиев С. Н., Мехтиева О .А., Ибрагимова З.М. Функциональные расстройства желчного пузыря и неалкогольная жировая болезнь печени: клинические особенности и новые подходы к терапии. Медицинский совет. 2020;(15)</li>
          <li>Мехтиев С.Н., Мехтиева О.А., Ухова М.В., Ибрагимова З.М. Современный взгляд на значение холецистэктомии в прогнозе пациента с неалкогольной жировой болезнью печени: алгоритм наблюдения и терапевтические подходы. РМЖ. Медицинское обозрение. 2021;5(*):1—9. <a href="https://doi.org/10.32364/2587-6821-2021-5-*-1-9" class="c1-ref-link" target="_blank" rel="noopener">DOI: 10.32364/2587-6821-2021-5-*-1-9</a>.</li>
          <li>Никитин И.Г., Волнухин А.В. Желчнокаменная болезнь: эпидемиологические данные, ключевые аспекты патогенеза и коморбидности, актуальные терапевтические мишени. РМЖ. Медицинское обозрение. 2020;4(*):1—7. <a href="https://doi.org/10.32364/2587-6821-2020-4-*-1-7" class="c1-ref-link" target="_blank" rel="noopener">DOI: 10.32364/2587—6821—2020—4-*-1-7</a>. * по данным ГРЛС</li>
        </ol>
      </div>

      <!-- Сюда позже добавишь только рабочие кнопки и поля формы -->
      <!-- <a href="#" class="btn-hotspot" style="left: 100px; top: 200px; width: 200px; height: 50px;"></a> -->

    </main>

    <!-- Модалка неправильного ответа -->
    <div class="c1-wrong-overlay" id="c1WrongOverlay">
      <div class="c1-wrong-modal">
        <div class="c1-wrong-title">Ответ<br>неверный</div>
        <button class="c1-wrong-btn">Попробовать ещё раз</button>
      </div>
    </div>

  <script>
    // Масштабирование страницы для экранов уже 375px через viewport
    (function() {
      var meta = document.querySelector('meta[name="viewport"]');
      if (!meta) return;
      var fixed = false;
      var busy = false;

      function fixViewport() {
        if (busy) return;
        if (!fixed) {
          var vw = window.innerWidth || 375;
          if (vw < 375) {
            busy = true; fixed = true;
            meta.setAttribute('content', 'width=375');
            setTimeout(function() { busy = false; }, 500);
          }
        } else {
          var ow = window.outerWidth || 375;
          if (ow >= 400) {
            busy = true; fixed = false;
            meta.setAttribute('content', 'width=device-width, initial-scale=1');
            setTimeout(function() { busy = false; }, 500);
          }
        }
      }

      fixViewport();
      window.addEventListener('resize', fixViewport);
    })();

    document.addEventListener('DOMContentLoaded', function() {
      var btn2 = document.querySelector('.c1-quiz-btn--2');
      var answerWindow = document.querySelector('.c1-answer-window');
      var handle = document.querySelector('.c1-aw-handle');
      if (!answerWindow || !handle) return;

      // Позиции по viewport: десктоп / планшет / мобильный
      function getPositions() {
        if (window.innerWidth <= 760) {
          return { start: 3899, revealed: 3330 };
        }
        if (window.innerWidth <= 1120) {
          return { start: 3322, revealed: 2388 };
        }
        return { start: 3322, revealed: 2687 };
      }

      var pos = getPositions();
      var startTop = pos.start;
      var revealedTop = pos.revealed;

      // Нажатие на кнопку 2 — выезд вверх
      if (btn2) {
        btn2.addEventListener('click', function() {
          pos = getPositions();
          startTop = pos.start;
          revealedTop = pos.revealed;
          answerWindow.classList.remove('dragging');
          answerWindow.classList.add('revealed');
          answerWindow.style.top = '';
          trapPageScroll();
        });
      }

      // Перетаскивание за верх — только вниз, обратно на место
      var isDragging = false;
      var dragStartY = 0;
      var dragStartTop = 0;

      handle.addEventListener('mousedown', function(e) {
        if (!answerWindow.classList.contains('revealed')) return;
        isDragging = true;
        dragStartY = e.clientY;
        dragStartTop = parseInt(window.getComputedStyle(answerWindow).top) || revealedTop;
        answerWindow.classList.add('dragging');
        e.preventDefault();
      });

      // Хелпер: ставим top с !important чтобы перебить CSS !important в медиа
      function setTop(val) {
        answerWindow.style.setProperty('top', val + 'px', 'important');
      }
      function clearTop() {
        answerWindow.style.removeProperty('top');
      }

      document.addEventListener('mousemove', function(e) {
        if (!isDragging) return;
        var deltaY = e.clientY - dragStartY;
        var newTop = Math.max(revealedTop, dragStartTop + deltaY);
        newTop = Math.min(newTop, startTop);
        setTop(newTop);
      });

      document.addEventListener('mouseup', function() {
        if (!isDragging) return;
        isDragging = false;
        answerWindow.classList.remove('dragging');

        var currentTop = parseInt(window.getComputedStyle(answerWindow).top) || revealedTop;
        var thresholdPct = (window.innerWidth <= 1120) ? 0.10 : 0.4;
        var threshold = revealedTop + (startTop - revealedTop) * thresholdPct;

        if (currentTop > threshold) {
          answerWindow.classList.remove('revealed');
          clearTop();
          untrapPageScroll();
        } else {
          clearTop();
        }
      });

      // Поддержка тач-событий
      handle.addEventListener('touchstart', function(e) {
        if (!answerWindow.classList.contains('revealed')) return;
        isDragging = true;
        dragStartY = e.touches[0].clientY;
        dragStartTop = parseInt(window.getComputedStyle(answerWindow).top) || revealedTop;
        answerWindow.classList.add('dragging');
        e.preventDefault();
      }, { passive: false });

      document.addEventListener('touchmove', function(e) {
        if (!isDragging) return;
        var deltaY = e.touches[0].clientY - dragStartY;
        var newTop = Math.max(revealedTop, dragStartTop + deltaY);
        newTop = Math.min(newTop, startTop);
        setTop(newTop);
      }, { passive: false });

      document.addEventListener('touchend', function() {
        if (!isDragging) return;
        isDragging = false;
        answerWindow.classList.remove('dragging');

        var currentTop = parseInt(window.getComputedStyle(answerWindow).top) || revealedTop;
        var thresholdPct = (window.innerWidth <= 1120) ? 0.10 : 0.4;
        var threshold = revealedTop + (startTop - revealedTop) * thresholdPct;

        if (currentTop > threshold) {
          answerWindow.classList.remove('revealed');
          clearTop();
          untrapPageScroll();
        } else {
          clearTop();
        }
      });

      // --- Закрытие окна ответа по клику вне блока ---
      document.addEventListener('click', function(e) {
        if (!answerWindow.classList.contains('revealed')) return;
        if (answerWindow.contains(e.target)) return;
        // Не закрываем при клике на кнопки квиза
        if (e.target.closest('.c1-quiz-btn')) return;
        answerWindow.classList.remove('revealed');
        clearTop();
        untrapPageScroll();
      });

      // --- Scroll trap для мобильного: общий скролл скроллит текст ответа ---
      var awBody = document.querySelector('.c1-aw-body');
      var infoTitle = document.querySelector('.c1-text--info-title');
      var scrollTrapped = false;
      var trapPaused = false;
      var trapLastTouchY = 0;

      function isAwBodyInView() {
        if (!awBody) return false;
        var rect = awBody.getBoundingClientRect();
        return rect.top < window.innerHeight && rect.bottom > 0;
      }

      function trapPageScroll() {
        if (window.innerWidth > 760 || scrollTrapped) return;
        if (awBody && awBody.scrollHeight <= awBody.clientHeight + 2) return;
        scrollTrapped = true;
        trapPaused = true;
        if (awBody) awBody.scrollTop = 0;
        document.addEventListener('touchstart', onTrapTouchStart, { passive: true });
        document.addEventListener('touchmove', onTrapTouchMove, { passive: false });
        window.addEventListener('wheel', onTrapWheel, { passive: false });
      }

      function untrapPageScroll() {
        if (!scrollTrapped) return;
        scrollTrapped = false;
        trapPaused = false;
        document.removeEventListener('touchstart', onTrapTouchStart);
        document.removeEventListener('touchmove', onTrapTouchMove);
        window.removeEventListener('wheel', onTrapWheel);
      }

      function onTrapTouchStart(e) {
        trapLastTouchY = e.touches[0].clientY;
      }

      function onTrapTouchMove(e) {
        if (isDragging) return;

        var touchY = e.touches[0].clientY;
        var deltaY = trapLastTouchY - touchY;
        trapLastTouchY = touchY;

        var atBottom = awBody.scrollTop + awBody.clientHeight >= awBody.scrollHeight - 2;
        var atTop = awBody.scrollTop <= 0;

        // Дочитал до конца — снимаем захват навсегда
        if (atBottom && deltaY > 0) {
          untrapPageScroll();
          return;
        }

        // Пауза: пользователь ушёл вверх — ждём возврата
        if (trapPaused) {
          // Возврат: верх блока «Информация для специалистов» вошёл во вьюпорт
          if (infoTitle && deltaY > 0) {
            var infoRect = infoTitle.getBoundingClientRect();
            if (infoRect.top <= window.innerHeight) {
              trapPaused = false;
              e.preventDefault();
              awBody.scrollTop += deltaY;
            }
          }
          return;
        }

        if (!isAwBodyInView()) return;

        // Текст вверху и скролл вверх — пауза, отпускаем страницу
        if (atTop && deltaY < 0) {
          trapPaused = true;
          return;
        }

        e.preventDefault();
        awBody.scrollTop += deltaY;
      }

      function onTrapWheel(e) {
        if (isDragging) return;

        var atBottom = awBody.scrollTop + awBody.clientHeight >= awBody.scrollHeight - 2;
        var atTop = awBody.scrollTop <= 0;

        if (atBottom && e.deltaY > 0) {
          untrapPageScroll();
          return;
        }

        if (trapPaused) {
          if (infoTitle && e.deltaY > 0) {
            var infoRect = infoTitle.getBoundingClientRect();
            if (infoRect.top <= window.innerHeight) {
              trapPaused = false;
              e.preventDefault();
              awBody.scrollTop += e.deltaY;
            }
          }
          return;
        }

        if (!isAwBodyInView()) return;

        if (atTop && e.deltaY < 0) {
          trapPaused = true;
          return;
        }

        e.preventDefault();
        awBody.scrollTop += e.deltaY;
      }

      // --- Модалка неправильного ответа ---
      var btn1 = document.querySelector('.c1-quiz-btn--1');
      var btn3 = document.querySelector('.c1-quiz-btn--3');
      var overlay = document.getElementById('c1WrongOverlay');
      var wrongBtn = document.querySelector('.c1-wrong-btn');

      // Блокировка скролла через перехват событий (не ломает layout)
      function preventScroll(e) { e.preventDefault(); }
      var scrollEvents = ['wheel', 'touchmove'];

      function showWrong() {
        if (overlay) overlay.classList.add('active');
        document.body.classList.add('modal-open');
        scrollEvents.forEach(function(evt) {
          window.addEventListener(evt, preventScroll, { passive: false });
        });
      }
      function hideWrong() {
        if (overlay) overlay.classList.remove('active');
        document.body.classList.remove('modal-open');
        scrollEvents.forEach(function(evt) {
          window.removeEventListener(evt, preventScroll);
        });
      }

      if (btn1) btn1.addEventListener('click', showWrong);
      if (btn3) btn3.addEventListener('click', showWrong);

      // Закрытие по кнопке «Попробовать ещё раз»
      if (wrongBtn) wrongBtn.addEventListener('click', hideWrong);

      // Закрытие по клику на область за модалкой
      if (overlay) {
        overlay.addEventListener('click', function(e) {
          if (e.target === overlay) hideWrong();
        });
      }
    });
  </script>
  </body>

  </html>